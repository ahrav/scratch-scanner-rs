//! Gitleaks-inspired rule set for the scanner.
//!
//! Purpose: provide a curated `Vec<RuleSpec>` suitable for default scanning.
//! The rules favor ASCII anchors/keywords so the engine can derive UTF-16
//! variants automatically and apply cheap gates before regex validation.
//!
//! # Invariants
//! - Anchors and keyword gates are ASCII-ish literals aligned with the regex intent.
//! - Regexes are compiled as bytes regexes with Unicode disabled.
//! - The output order is stable but does not imply rule priority.
//! - Any change to rule literals, regex, or config should be treated as a
//!   policy change and reflected in downstream benchmarking.

use crate::api::{EntropySpec, LocalContextSpec, RuleSpec, TwoPhaseSpec, ValidatorKind};
use regex::bytes::Regex;

/// Progressive regex size limits (bytes) to tolerate large DFAs on complex rules.
///
/// We retry compilation on `CompiledTooBig` so a single oversized rule does not
/// require globally lifting size limits for all patterns.
const REGEX_SIZE_LIMITS: &[usize] = &[32 * 1024 * 1024, 128 * 1024 * 1024, 512 * 1024 * 1024];

/// Build a bytes regex with increasing size limits.
///
/// Panics if the pattern is invalid or exceeds the maximum configured limits.
fn build_regex(pattern: &str) -> Regex {
    for &limit in REGEX_SIZE_LIMITS {
        let mut builder = regex::bytes::RegexBuilder::new(pattern);
        builder.unicode(false);
        builder.size_limit(limit);
        builder.dfa_size_limit(limit);
        match builder.build() {
            Ok(re) => return re,
            Err(regex::Error::CompiledTooBig(_)) => continue,
            Err(err) => panic!("failed to compile regex: {err}"),
        }
    }
    panic!(
        "regex compiled too big even at {} bytes: {pattern}",
        REGEX_SIZE_LIMITS[REGEX_SIZE_LIMITS.len() - 1]
    );
}

/// Return the full gitleaks-derived rule suite.
///
/// The rules are expressed as `RuleSpec` with anchors/keywords tuned for fast
/// gating; regexes are validated at startup and will panic if compilation fails.
pub(crate) fn gitleaks_rules() -> Vec<RuleSpec> {
    const PRIVATE_KEY_CONFIRM: &[&[u8]] = &[b"PRIVATE KEY"];

    vec![
        RuleSpec {
            name: "1password-secret-key",
            anchors: &[b"a3-", b"A3-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"a3-", b"A3-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.8,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"\bA3-[A-Z0-9]{6}-(?:(?:[A-Z0-9]{11})|(?:[A-Z0-9]{6}-[A-Z0-9]{5}))-[A-Z0-9]{5}-[A-Z0-9]{5}-[A-Z0-9]{5}\b",
            ),
        },
        RuleSpec {
            name: "1password-service-account-token",
            anchors: &[b"ops_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ops_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            // Upper bound added to enable accurate max_width calculation
            local_context: None,
            secret_group: None,
            re: build_regex(r"ops_eyJ[a-zA-Z0-9+/]{250,2048}={0,3}"),
        },
        RuleSpec {
            name: "adafruit-api-key",
            anchors: &[b"adafruit", b"ADAFRUIT"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"adafruit", b"ADAFRUIT"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:adafruit)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9_-]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "adobe-client-id",
            anchors: &[b"adobe", b"ADOBE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"adobe", b"ADOBE"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:adobe)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "adobe-client-secret",
            anchors: &[b"p8e-", b"P8E-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"p8e-", b"P8E-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(p8e-(?i)[a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "age-secret-key",
            anchors: &[b"age-secret-key-1", b"AGE-SECRET-KEY-1"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"age-secret-key-1", b"AGE-SECRET-KEY-1"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r"AGE-SECRET-KEY-1[QPZRY9X8GF2TVDW0S3JN54KHCE6MUA7L]{58}"),
        },
        RuleSpec {
            name: "airtable-api-key",
            anchors: &[b"airtable", b"AIRTABLE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"airtable", b"AIRTABLE"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:airtable)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{17})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "airtable-personnal-access-token",
            // Token prefix is `pat...`; we anchor on "airtable" to require context.
            anchors: &[b"airtable"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"airtable"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r"\b(pat[[:alnum:]]{14}\.[a-f0-9]{64})\b"),
        },
        RuleSpec {
            name: "algolia-api-key",
            anchors: &[b"algolia", b"ALGOLIA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"algolia", b"ALGOLIA"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:algolia)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "alibaba-access-key-id",
            anchors: &[b"ltai", b"LTAI"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ltai", b"LTAI"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(LTAI(?i)[a-z0-9]{20})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "alibaba-secret-key",
            anchors: &[b"alibaba", b"ALIBABA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"alibaba", b"ALIBABA"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:alibaba)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{30})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "anthropic-admin-api-key",
            anchors: &[b"sk-ant-admin01"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sk-ant-admin01"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sk-ant-admin01-[a-zA-Z0-9_\-]{93}AA)(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "anthropic-api-key",
            anchors: &[b"sk-ant-api03"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sk-ant-api03"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sk-ant-api03-[a-zA-Z0-9_\-]{93}AA)(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "artifactory-api-key",
            anchors: &[b"akcp"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"akcp"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bAKCp[A-Za-z0-9]{69}\b"),
        },
        RuleSpec {
            name: "artifactory-reference-token",
            anchors: &[b"cmvmd"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"cmvmd"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bcmVmd[A-Za-z0-9]{59}\b"),
        },
        RuleSpec {
            name: "asana-client-id",
            anchors: &[b"asana", b"ASANA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"asana", b"ASANA"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:asana)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "asana-client-secret",
            anchors: &[b"asana", b"ASANA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"asana", b"ASANA"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:asana)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "atlassian-api-token",
            anchors: &[
                b"atlassian",
                b"ATLASSIAN",
                b"confluence",
                b"CONFLUENCE",
                b"jira",
                b"JIRA",
                b"atatt3",
                b"ATATT3",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"atlassian",
                b"ATLASSIAN",
                b"confluence",
                b"CONFLUENCE",
                b"jira",
                b"JIRA",
                b"atatt3",
                b"ATATT3",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:(?-i:ATLASSIAN|[Aa]tlassian)|(?-i:CONFLUENCE|[Cc]onfluence)|(?-i:JIRA|[Jj]ira))(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{20}[a-f0-9]{4})(?:[\x60'"\s;]|\\[nr]|$)|\b(ATATT3[A-Za-z0-9_\-=]{186})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "authress-service-client-access-key",
            anchors: &[
                b"sc_",
                b"SC_",
                b"ext_",
                b"EXT_",
                b"scauth_",
                b"SCAUTH_",
                b"authress_",
                b"AUTHRESS_",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"sc_",
                b"SC_",
                b"ext_",
                b"EXT_",
                b"scauth_",
                b"SCAUTH_",
                b"authress_",
                b"AUTHRESS_",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b((?:sc|ext|scauth|authress)_(?i)[a-z0-9]{5,30}\.[a-z0-9]{4,6}\.(?-i:acc)[_-][a-z0-9-]{10,32}\.[a-z0-9+/_=-]{30,120})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "aws-access-token",
            // Only uppercase anchors - regex is case-sensitive: (A3T[A-Z0-9]|AKIA|ASIA|ABIA|ACCA)
            anchors: &[b"A3T", b"AKIA", b"ASIA", b"ABIA", b"ACCA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"A3T", b"AKIA", b"ASIA", b"ABIA", b"ACCA"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\b((?:A3T[A-Z0-9]|AKIA|ASIA|ABIA|ACCA)[A-Z2-7]{16})\b"),
        },
        RuleSpec {
            name: "aws-amazon-bedrock-api-key-long-lived",
            anchors: &[b"absk", b"ABSK"],
            radius: 333,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"absk", b"ABSK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 269,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(ABSK[A-Za-z0-9+/]{109,269}={0,2})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "aws-amazon-bedrock-api-key-short-lived",
            anchors: &[b"bedrock-api-key-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"bedrock-api-key-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"bedrock-api-key-YmVkcm9jay5hbWF6b25hd3MuY29t"),
        },
        // OPTIMIZED: Azure AD client secrets contain "\dQ~" - digit followed by "Q~".
        // The "Q~" anchor alone is too short (2 chars < min_anchor_len=3).
        // Extend anchors to "[0-9]Q~" patterns (3 chars each) for 10 variants.
        // This is safe: any match containing \dQ~ must contain one of these anchors.
        RuleSpec {
            name: "azure-ad-client-secret",
            anchors: &[
                b"0Q~", b"1Q~", b"2Q~", b"3Q~", b"4Q~", b"5Q~", b"6Q~", b"7Q~", b"8Q~", b"9Q~",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"Q~"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?:^|[\\'"\x60\s>=:(,)])([a-zA-Z0-9_~.]{3}\dQ~[a-zA-Z0-9_~.-]{31,34})(?:$|[\\'"\x60\s<),])"#,
            ),
        },
        RuleSpec {
            name: "beamer-api-token",
            anchors: &[b"beamer", b"BEAMER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"beamer", b"BEAMER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:beamer)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(b_[a-z0-9=_\-]{44})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "bitbucket-client-id",
            anchors: &[b"bitbucket", b"BITBUCKET"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"bitbucket", b"BITBUCKET"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:bitbucket)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "bitbucket-client-secret",
            anchors: &[b"bitbucket", b"BITBUCKET"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"bitbucket", b"BITBUCKET"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:bitbucket)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "bittrex-access-key",
            anchors: &[b"bittrex", b"BITTREX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"bittrex", b"BITTREX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:bittrex)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "bittrex-secret-key",
            anchors: &[b"bittrex", b"BITTREX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"bittrex", b"BITTREX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:bittrex)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "cisco-meraki-api-key",
            anchors: &[b"meraki", b"MERAKI"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"meraki", b"MERAKI"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"[\w.-]{0,50}?(?i:[\w.-]{0,50}?(?:(?-i:[Mm]eraki|MERAKI))(?:[ \t\w.-]{0,20})[\s'"]{0,3})(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "clickhouse-cloud-api-secret-key",
            anchors: &[b"4b1d"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"4b1d"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\b(4b1d[A-Za-z0-9]{38})\b"),
        },
        RuleSpec {
            name: "clojars-api-token",
            anchors: &[b"clojars_", b"CLOJARS_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"clojars_", b"CLOJARS_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)CLOJARS_[a-z0-9]{60}"),
        },
        RuleSpec {
            name: "cloudflare-api-key",
            anchors: &[b"cloudflare", b"CLOUDFLARE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"cloudflare", b"CLOUDFLARE"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:cloudflare)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9_-]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "cloudflare-global-api-key",
            anchors: &[b"cloudflare", b"CLOUDFLARE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"cloudflare", b"CLOUDFLARE"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:cloudflare)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{37})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "cloudflare-origin-ca-key",
            anchors: &[b"cloudflare", b"v1.0-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"cloudflare", b"v1.0-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(v1\.0-[a-f0-9]{24}-[a-f0-9]{146})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "codecov-access-token",
            anchors: &[b"codecov", b"CODECOV"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"codecov", b"CODECOV"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:codecov)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "cohere-api-token",
            anchors: &[b"cohere", b"co_api_key", b"CO_API_KEY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"cohere", b"co_api_key", b"CO_API_KEY"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"[\w.-]{0,50}?(?i:[\w.-]{0,50}?(?:cohere|CO_API_KEY)(?:[ \t\w.-]{0,20})[\s'"]{0,3})(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-zA-Z0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "coinbase-access-token",
            anchors: &[b"coinbase", b"COINBASE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"coinbase", b"COINBASE"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:coinbase)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9_-]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "confluent-access-token",
            anchors: &[b"confluent", b"CONFLUENT"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"confluent", b"CONFLUENT"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:confluent)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "confluent-secret-key",
            anchors: &[b"confluent", b"CONFLUENT"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"confluent", b"CONFLUENT"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:confluent)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "contentful-delivery-api-token",
            anchors: &[b"contentful", b"CONTENTFUL"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"contentful", b"CONTENTFUL"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:contentful)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{43})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "curl-auth-header",
            anchors: &[b"curl", b"CURL"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"curl", b"CURL"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.75,
                min_len: 16,
                max_len: 256,
            }),
            // Bounded .{0,2048}? to enable accurate max_width calculation
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\bcurl\b(?:.{0,2048}?|.{0,2048}?(?:[\r\n]{1,2}.{0,2048}?){1,5})[ \t\n\r](?:-H|--header)(?:=|[ \t]{0,5})(?:"(?i)(?:Authorization:[ \t]{0,5}(?:Basic[ \t]([a-z0-9+/]{8,}={0,3})|(?:Bearer|(?:Api-)?Token)[ \t]([\w=~@.+/-]{8,})|([\w=~@.+/-]{8,}))|(?:(?:X-(?:[a-z]+-)?)?(?:Api-?)?(?:Key|Token)):[ \t]{0,5}([\w=~@.+/-]{8,}))"|'(?i)(?:Authorization:[ \t]{0,5}(?:Basic[ \t]([a-z0-9+/]{8,}={0,3})|(?:Bearer|(?:Api-)?Token)[ \t]([\w=~@.+/-]{8,})|([\w=~@.+/-]{8,}))|(?:(?:X-(?:[a-z]+-)?)?(?:Api-?)?(?:Key|Token)):[ \t]{0,5}([\w=~@.+/-]{8,}))')(?:\B|\s|\z)"#,
            ),
        },
        RuleSpec {
            name: "curl-auth-user",
            anchors: &[b"curl"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"curl"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            // Bounded .{0,2048} to enable accurate max_width calculation
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\bcurl\b(?:.{0,2048}|.{0,2048}(?:[\r\n]{1,2}.{0,2048}){1,5})[ \t\n\r](?:-u|--user)(?:=|[ \t]{0,5})("(:[^"]{3,}|[^:"]{3,}:|[^:"]{3,}:[^"]{3,})"|'([^:']{3,}:[^']{3,})'|((?:"[^"]{3,}"|'[^']{3,}'|[\w$@.-]+):(?:"[^"]{3,}"|'[^']{3,}'|[\w${}@.-]+)))(?:\s|\z)"#,
            ),
        },
        RuleSpec {
            name: "databricks-api-token",
            anchors: &[b"dapi"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dapi"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(dapi[a-f0-9]{32}(?:-\d)?)(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "datadog-access-token",
            anchors: &[b"datadog", b"DATADOG"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"datadog", b"DATADOG"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:datadog)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "defined-networking-api-token",
            anchors: &[b"dnkey", b"DNKEY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dnkey", b"DNKEY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:dnkey)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(dnkey-[a-z0-9=_\-]{26}-[a-z0-9=_\-]{52})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "digitalocean-access-token",
            anchors: &[b"doo_v1_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"doo_v1_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(doo_v1_[a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "digitalocean-pat",
            anchors: &[b"dop_v1_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dop_v1_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(dop_v1_[a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "digitalocean-refresh-token",
            anchors: &[b"dor_v1_", b"DOR_V1_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dor_v1_", b"DOR_V1_"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(dor_v1_[a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "discord-api-token",
            anchors: &[b"discord", b"DISCORD"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"discord", b"DISCORD"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:discord)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "discord-client-id",
            anchors: &[b"discord", b"DISCORD"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"discord", b"DISCORD"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:discord)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9]{18})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "discord-client-secret",
            anchors: &[b"discord", b"DISCORD"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"discord", b"DISCORD"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:discord)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "doppler-api-token",
            anchors: &[b"dp.pt.", b"DP.PT."],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dp.pt.", b"DP.PT."]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"dp\.pt\.(?i)[a-z0-9]{43}"),
        },
        RuleSpec {
            name: "droneci-access-token",
            anchors: &[b"droneci", b"DRONECI"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"droneci", b"DRONECI"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:droneci)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "dropbox-api-token",
            anchors: &[b"dropbox", b"DROPBOX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dropbox", b"DROPBOX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:dropbox)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{15})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "dropbox-long-lived-api-token",
            anchors: &[b"dropbox", b"DROPBOX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dropbox", b"DROPBOX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:dropbox)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{11}(AAAAAAAAAA)[a-z0-9\-_=]{43})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "dropbox-short-lived-api-token",
            anchors: &[b"dropbox", b"DROPBOX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dropbox", b"DROPBOX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:dropbox)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(sl\.[a-z0-9\-=_]{135})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "duffel-api-token",
            anchors: &[b"duffel_", b"DUFFEL_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"duffel_", b"DUFFEL_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"duffel_(?:test|live)_(?i)[a-z0-9_\-=]{43}"),
        },
        RuleSpec {
            name: "dynatrace-api-token",
            anchors: &[b"dt0c01.", b"DT0C01."],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"dt0c01.", b"DT0C01."]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"dt0c01\.(?i)[a-z0-9]{24}\.[a-z0-9]{64}"),
        },
        RuleSpec {
            name: "easypost-api-token",
            anchors: &[b"ezak", b"EZAK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ezak", b"EZAK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bEZAK(?i)[a-z0-9]{54}\b"),
        },
        RuleSpec {
            name: "easypost-test-api-token",
            anchors: &[b"eztk", b"EZTK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"eztk", b"EZTK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bEZTK(?i)[a-z0-9]{54}\b"),
        },
        RuleSpec {
            name: "etsy-access-token",
            anchors: &[b"etsy", b"ETSY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"etsy", b"ETSY"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:(?-i:ETSY|[Ee]tsy))(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{24})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "facebook-access-token",
            anchors: &[b"facebook", b"FACEBOOK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"facebook", b"FACEBOOK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(\d{15,16}(\||%)[0-9a-z\-_]{27,40})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "facebook-page-access-token",
            // Only uppercase anchors - regex requires uppercase: EAA[MC](?i)
            anchors: &[b"EAAM", b"EAAC"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"EAAM", b"EAAC"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(EAA[MC](?i)[a-z0-9]{100,})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "facebook-secret",
            anchors: &[b"facebook", b"FACEBOOK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"facebook", b"FACEBOOK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:facebook)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "fastly-api-token",
            anchors: &[b"fastly", b"FASTLY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"fastly", b"FASTLY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:fastly)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "finicity-api-token",
            anchors: &[b"finicity", b"FINICITY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"finicity", b"FINICITY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:finicity)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "finicity-client-secret",
            anchors: &[b"finicity", b"FINICITY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"finicity", b"FINICITY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:finicity)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{20})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "finnhub-access-token",
            anchors: &[b"finnhub", b"FINNHUB"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"finnhub", b"FINNHUB"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:finnhub)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{20})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "flickr-access-token",
            anchors: &[b"flickr", b"FLICKR"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"flickr", b"FLICKR"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:flickr)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "flutterwave-encryption-key",
            anchors: &[b"flwseck_test", b"FLWSECK_TEST"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"flwseck_test", b"FLWSECK_TEST"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"FLWSECK_TEST-(?i)[a-h0-9]{12}"),
        },
        RuleSpec {
            name: "flutterwave-public-key",
            anchors: &[b"flwpubk_test", b"FLWPUBK_TEST"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"flwpubk_test", b"FLWPUBK_TEST"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"FLWPUBK_TEST-(?i)[a-h0-9]{32}-X"),
        },
        RuleSpec {
            name: "flutterwave-secret-key",
            anchors: &[b"flwseck_test", b"FLWSECK_TEST"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"flwseck_test", b"FLWSECK_TEST"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"FLWSECK_TEST-(?i)[a-h0-9]{32}-X"),
        },
        RuleSpec {
            name: "flyio-access-token",
            anchors: &[b"fo1_", b"fm1", b"fm2_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"fo1_", b"fm1", b"fm2_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            // Upper bounds added to enable accurate max_width calculation
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b((?:fo1_[\w-]{43}|fm1[ar]_[a-zA-Z0-9+\/]{100,1024}={0,3}|fm2_[a-zA-Z0-9+\/]{100,1024}={0,3}))(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "frameio-api-token",
            anchors: &[b"fio-u-", b"FIO-U-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"fio-u-", b"FIO-U-"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r"fio-u-(?i)[a-z0-9\-_=]{64}"),
        },
        RuleSpec {
            name: "freemius-secret-key",
            anchors: &[b"secret_key", b"SECRET_KEY"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"secret_key", b"SECRET_KEY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)["']secret_key["']\s*=>\s*["'](sk_[\S]{29})["']"#),
        },
        RuleSpec {
            name: "freshbooks-access-token",
            anchors: &[b"freshbooks", b"FRESHBOOKS"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"freshbooks", b"FRESHBOOKS"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:freshbooks)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "gcp-api-key",
            anchors: &[b"aiza"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"aiza"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(AIza[\w-]{35})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "generic-api-key",
            anchors: &[
                b"access",
                b"ACCESS",
                b"api",
                b"API",
                b"auth",
                b"AUTH",
                b"key",
                b"KEY",
                b"credential",
                b"CREDENTIAL",
                b"creds",
                b"CREDS",
                b"passwd",
                b"PASSWD",
                b"password",
                b"PASSWORD",
                b"secret",
                b"SECRET",
                b"token",
                b"TOKEN",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"access",
                b"ACCESS",
                b"api",
                b"API",
                b"auth",
                b"AUTH",
                b"key",
                b"KEY",
                b"credential",
                b"CREDENTIAL",
                b"creds",
                b"CREDS",
                b"passwd",
                b"PASSWD",
                b"password",
                b"PASSWORD",
                b"secret",
                b"SECRET",
                b"token",
                b"TOKEN",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            // Local context gate: require assignment shape on the same line and
            // a nearby key name to reduce noisy token-only matches.
            local_context: Some(LocalContextSpec {
                lookbehind: 256,
                lookahead: 128,
                require_same_line_assignment: true,
                require_quoted: false,
                key_names_any: Some(&[
                    b"access",
                    b"ACCESS",
                    b"api",
                    b"API",
                    b"auth",
                    b"AUTH",
                    b"key",
                    b"KEY",
                    b"credential",
                    b"CREDENTIAL",
                    b"creds",
                    b"CREDS",
                    b"passwd",
                    b"PASSWD",
                    b"password",
                    b"PASSWORD",
                    b"secret",
                    b"SECRET",
                    b"token",
                    b"TOKEN",
                ]),
            }),
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:access|auth|(?-i:[Aa]pi|API)|credential|creds|key|passw(?:or)?d|secret|token)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([\w.=-]{10,150}|[a-z0-9][a-z0-9+/]{11,}={0,3})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "github-app-token",
            anchors: &[b"ghu_", b"ghs_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ghu_", b"ghs_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?:ghu|ghs)_[0-9a-zA-Z]{36}"),
        },
        RuleSpec {
            name: "github-fine-grained-pat",
            anchors: &[b"github_pat_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"github_pat_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"github_pat_\w{82}"),
        },
        RuleSpec {
            name: "github-oauth",
            anchors: &[b"gho_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"gho_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"gho_[0-9a-zA-Z]{36}"),
        },
        RuleSpec {
            name: "github-pat",
            anchors: &[b"ghp_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ghp_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"ghp_[0-9a-zA-Z]{36}"),
        },
        RuleSpec {
            name: "github-refresh-token",
            anchors: &[b"ghr_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ghr_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"ghr_[0-9a-zA-Z]{36}"),
        },
        RuleSpec {
            name: "gitlab-cicd-job-token",
            anchors: &[b"glcbt-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glcbt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glcbt-[0-9a-zA-Z]{1,5}_[0-9a-zA-Z_-]{20}"),
        },
        RuleSpec {
            name: "gitlab-deploy-token",
            anchors: &[b"gldt-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"gldt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"gldt-[0-9a-zA-Z_\-]{20}"),
        },
        RuleSpec {
            name: "gitlab-feature-flag-client-token",
            anchors: &[b"glffct-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glffct-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glffct-[0-9a-zA-Z_\-]{20}"),
        },
        RuleSpec {
            name: "gitlab-feed-token",
            anchors: &[b"glft-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glft-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glft-[0-9a-zA-Z_\-]{20}"),
        },
        RuleSpec {
            name: "gitlab-incoming-mail-token",
            anchors: &[b"glimt-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glimt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glimt-[0-9a-zA-Z_\-]{25}"),
        },
        RuleSpec {
            name: "gitlab-kubernetes-agent-token",
            anchors: &[b"glagent-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glagent-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glagent-[0-9a-zA-Z_\-]{50}"),
        },
        RuleSpec {
            name: "gitlab-oauth-app-secret",
            anchors: &[b"gloas-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"gloas-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"gloas-[0-9a-zA-Z_\-]{64}"),
        },
        RuleSpec {
            name: "gitlab-pat",
            anchors: &[b"glpat-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glpat-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glpat-[\w-]{20}"),
        },
        RuleSpec {
            name: "gitlab-pat-routable",
            anchors: &[b"glpat-"],
            radius: 364,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glpat-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 300,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bglpat-[0-9a-zA-Z_-]{27,300}\.[0-9a-z]{2}[0-9a-z]{7}\b"),
        },
        RuleSpec {
            name: "gitlab-ptt",
            anchors: &[b"glptt-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glptt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glptt-[0-9a-f]{40}"),
        },
        RuleSpec {
            name: "gitlab-rrt",
            anchors: &[b"gr1348941", b"GR1348941"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"gr1348941", b"GR1348941"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"GR1348941[\w-]{20}"),
        },
        RuleSpec {
            name: "gitlab-runner-authentication-token",
            anchors: &[b"glrt-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glrt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glrt-[0-9a-zA-Z_\-]{20}"),
        },
        RuleSpec {
            name: "gitlab-runner-authentication-token-routable",
            anchors: &[b"glrt-"],
            radius: 364,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glrt-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 300,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\bglrt-t\d_[0-9a-zA-Z_\-]{27,300}\.[0-9a-z]{2}[0-9a-z]{7}\b"),
        },
        RuleSpec {
            name: "gitlab-scim-token",
            anchors: &[b"glsoat-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glsoat-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"glsoat-[0-9a-zA-Z_\-]{20}"),
        },
        RuleSpec {
            name: "gitlab-session-cookie",
            anchors: &[b"_gitlab_session="],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"_gitlab_session="]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"_gitlab_session=[0-9a-z]{32}"),
        },
        RuleSpec {
            name: "gitter-access-token",
            anchors: &[b"gitter", b"GITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"gitter", b"GITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:gitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9_-]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "gocardless-api-token",
            anchors: &[b"live_", b"LIVE_", b"gocardless", b"GOCARDLESS"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"live_", b"LIVE_", b"gocardless", b"GOCARDLESS"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:gocardless)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(live_(?i)[a-z0-9\-_=]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "grafana-api-key",
            anchors: &[b"eyjrijoi", b"EYJRIJOI"],
            radius: 464,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"eyjrijoi", b"EYJRIJOI"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 400,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(eyJrIjoi[A-Za-z0-9]{70,400}={0,3})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "grafana-cloud-api-token",
            anchors: &[b"glc_", b"GLC_"],
            radius: 464,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glc_", b"GLC_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 400,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(glc_[A-Za-z0-9+/]{32,400}={0,3})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "grafana-service-account-token",
            anchors: &[b"glsa_", b"GLSA_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"glsa_", b"GLSA_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)\b(glsa_[A-Za-z0-9]{32}_[A-Fa-f0-9]{8})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "harness-api-key",
            anchors: &[b"pat.", b"sat."],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pat.", b"sat."]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?:pat|sat)\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9]{24}\.[a-zA-Z0-9]{20}"),
        },
        RuleSpec {
            name: "hashicorp-tf-api-token",
            anchors: &[b"atlasv1", b"ATLASV1"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"atlasv1", b"ATLASV1"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)[a-z0-9]{14}\.(?-i:atlasv1)\.[a-z0-9\-_=]{60,70}"),
        },
        RuleSpec {
            name: "hashicorp-tf-password",
            anchors: &[
                b"administrator_login_password",
                b"ADMINISTRATOR_LOGIN_PASSWORD",
                b"password",
                b"PASSWORD",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"administrator_login_password",
                b"ADMINISTRATOR_LOGIN_PASSWORD",
                b"password",
                b"PASSWORD",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:administrator_login_password|password)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}("[a-z0-9=_\-]{8,20}")(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "heroku-api-key",
            anchors: &[b"heroku", b"HEROKU"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"heroku", b"HEROKU"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:heroku)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "heroku-api-key-v2",
            anchors: &[b"hrku-aa", b"HRKU-AA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hrku-aa", b"HRKU-AA"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b((HRKU-AA[0-9a-zA-Z_-]{58}))(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "hubspot-api-key",
            anchors: &[b"hubspot", b"HUBSPOT"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hubspot", b"HUBSPOT"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:hubspot)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "huggingface-access-token",
            anchors: &[b"hf_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hf_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(hf_(?i:[a-z]{34}))(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "huggingface-organization-api-token",
            anchors: &[b"api_org_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"api_org_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(api_org_(?i:[a-z]{34}))(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "infracost-api-token",
            anchors: &[b"ico-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ico-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(ico-[a-zA-Z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "intercom-api-key",
            anchors: &[b"intercom", b"INTERCOM"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"intercom", b"INTERCOM"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:intercom)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{60})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "intra42-client-secret",
            anchors: &[
                b"intra",
                b"INTRA",
                b"s-s4t2ud-",
                b"S-S4T2UD-",
                b"s-s4t2af-",
                b"S-S4T2AF-",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"intra",
                b"INTRA",
                b"s-s4t2ud-",
                b"S-S4T2UD-",
                b"s-s4t2af-",
                b"S-S4T2AF-",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b(s-s4t2(?:ud|af)-(?i)[abcdef0123456789]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "jfrog-api-key",
            anchors: &[
                b"jfrog",
                b"JFROG",
                b"artifactory",
                b"ARTIFACTORY",
                b"bintray",
                b"BINTRAY",
                b"xray",
                b"XRAY",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"jfrog",
                b"JFROG",
                b"artifactory",
                b"ARTIFACTORY",
                b"bintray",
                b"BINTRAY",
                b"xray",
                b"XRAY",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:jfrog|artifactory|bintray|xray)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{73})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "jfrog-identity-token",
            anchors: &[
                b"jfrog",
                b"JFROG",
                b"artifactory",
                b"ARTIFACTORY",
                b"bintray",
                b"BINTRAY",
                b"xray",
                b"XRAY",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"jfrog",
                b"JFROG",
                b"artifactory",
                b"ARTIFACTORY",
                b"bintray",
                b"BINTRAY",
                b"xray",
                b"XRAY",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:jfrog|artifactory|bintray|xray)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        // OPTIMIZED: Extended anchor from "ey" (2 chars) to "eyJ" (3 chars).
        // All valid JWTs start with "eyJ" because:
        // - JWT header is base64-encoded JSON object
        // - JSON objects start with "{"
        // - Base64 of "{\"" is "eyJ" (regardless of what follows the quote)
        // This reduces false anchor matches by ~2.4x on typical data.
        // See docs/anchor_optimization_spec.md for safety analysis.
        RuleSpec {
            name: "jwt",
            anchors: &[b"eyJ"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"eyJ"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                // Changed: ey  eyJ, adjusted length requirement from 17 to 16 to maintain same total
                r#"\b(eyJ[a-zA-Z0-9]{16,}\.eyJ[a-zA-Z0-9\/\\_-]{16,}\.(?:[a-zA-Z0-9\/\\_-]{10,}={0,2})?)(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "jwt-base64",
            anchors: &[b"zxlk"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"zxlk"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"\bZXlK(?:(?P<alg>aGJHY2lPaU)|(?P<apu>aGNIVWlPaU)|(?P<apv>aGNIWWlPaU)|(?P<aud>aGRXUWlPaU)|(?P<b64>aU5qUWlP)|(?P<crit>amNtbDBJanBi)|(?P<cty>amRIa2lPaU)|(?P<epk>bGNHc2lPbn)|(?P<enc>bGJtTWlPaU)|(?P<jku>cWEzVWlPaU)|(?P<jwk>cWQyc2lPb)|(?P<iss>cGMzTWlPaU)|(?P<iv>cGRpSTZJ)|(?P<kid>cmFXUWlP)|(?P<key_ops>clpYbGZiM0J6SWpwY)|(?P<kty>cmRIa2lPaUp)|(?P<nonce>dWIyNWpaU0k2)|(?P<p2c>d01tTWlP)|(?P<p2s>d01uTWlPaU)|(?P<ppt>d2NIUWlPaU)|(?P<sub>emRXSWlPaU)|(?P<svt>emRuUWlP)|(?P<tag>MFlXY2lPaU)|(?P<typ>MGVYQWlPaUp)|(?P<url>MWNtd2l)|(?P<use>MWMyVWlPaUp)|(?P<ver>MlpYSWlPaU)|(?P<version>MlpYSnphVzl1SWpv)|(?P<x>NElqb2)|(?P<x5c>NE5XTWlP)|(?P<x5t>NE5YUWlPaU)|(?P<x5ts256>NE5YUWpVekkxTmlJNkl)|(?P<x5u>NE5YVWlPaU)|(?P<zip>NmFYQWlPaU))[a-zA-Z0-9\/\\_+\-\r\n]{40,}={0,2}",
            ),
        },
        RuleSpec {
            name: "kraken-access-token",
            anchors: &[b"kraken", b"KRAKEN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"kraken", b"KRAKEN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:kraken)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9\/=_\+\-]{80,90})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "kubernetes-secret-yaml",
            anchors: &[b"secret", b"SECRET"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"secret", b"SECRET"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)(?:\bkind:[ \t]*["']?\bsecret\b["']?(?s:.){0,200}?\bdata:(?s:.){0,100}?\s+([\w.-]+:(?:[ \t]*(?:\||>[-+]?)\s+)?[ \t]*(?:["']?[a-z0-9+/]{10,}={0,3}["']?|\{\{[ \t\w"|$:=,.-]+}}|""|''))|\bdata:(?s:.){0,100}?\s+([\w.-]+:(?:[ \t]*(?:\||>[-+]?)\s+)?[ \t]*(?:["']?[a-z0-9+/]{10,}={0,3}["']?|\{\{[ \t\w"|$:=,.-]+}}|""|''))(?s:.){0,200}?\bkind:[ \t]*["']?\bsecret\b["']?)"#,
            ),
        },
        RuleSpec {
            name: "kucoin-access-token",
            anchors: &[b"kucoin", b"KUCOIN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"kucoin", b"KUCOIN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:kucoin)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{24})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "kucoin-secret-key",
            anchors: &[b"kucoin", b"KUCOIN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"kucoin", b"KUCOIN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:kucoin)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "launchdarkly-access-token",
            anchors: &[b"launchdarkly", b"LAUNCHDARKLY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"launchdarkly", b"LAUNCHDARKLY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:launchdarkly)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "linear-api-key",
            anchors: &[b"lin_api_", b"LIN_API_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"lin_api_", b"LIN_API_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"lin_api_(?i)[a-z0-9]{40}"),
        },
        RuleSpec {
            name: "linear-client-secret",
            anchors: &[b"linear", b"LINEAR"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"linear", b"LINEAR"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:linear)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "linkedin-client-id",
            anchors: &[
                b"linkedin",
                b"LINKEDIN",
                b"linked_in",
                b"LINKED_IN",
                b"linked-in",
                b"LINKED-IN",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"linkedin",
                b"LINKEDIN",
                b"linked_in",
                b"LINKED_IN",
                b"linked-in",
                b"LINKED-IN",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:linked[_-]?in)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{14})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "linkedin-client-secret",
            anchors: &[
                b"linkedin",
                b"LINKEDIN",
                b"linked_in",
                b"LINKED_IN",
                b"linked-in",
                b"LINKED-IN",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"linkedin",
                b"LINKEDIN",
                b"linked_in",
                b"LINKED_IN",
                b"linked-in",
                b"LINKED-IN",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:linked[_-]?in)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "lob-api-key",
            anchors: &[b"test_", b"TEST_", b"live_", b"LIVE_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"test_", b"TEST_", b"live_", b"LIVE_"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:lob)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}((live|test)_[a-f0-9]{35})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "lob-pub-api-key",
            anchors: &[
                b"test_pub",
                b"TEST_PUB",
                b"live_pub",
                b"LIVE_PUB",
                b"_pub",
                b"_PUB",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"test_pub",
                b"TEST_PUB",
                b"live_pub",
                b"LIVE_PUB",
                b"_pub",
                b"_PUB",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:lob)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}((test|live)_pub_[a-f0-9]{31})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "looker-client-id",
            anchors: &[b"looker", b"LOOKER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"looker", b"LOOKER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:looker)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{20})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "looker-client-secret",
            anchors: &[b"looker", b"LOOKER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"looker", b"LOOKER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:looker)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{24})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mailchimp-api-key",
            anchors: &[b"mailchimp", b"MAILCHIMP"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mailchimp", b"MAILCHIMP"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:MailchimpSDK.initialize|mailchimp)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{32}-us\d\d)(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mailgun-private-api-token",
            anchors: &[b"mailgun", b"MAILGUN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mailgun", b"MAILGUN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:mailgun)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(key-[a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mailgun-pub-key",
            anchors: &[b"mailgun", b"MAILGUN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mailgun", b"MAILGUN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:mailgun)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(pubkey-[a-f0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mailgun-signing-key",
            anchors: &[b"mailgun", b"MAILGUN"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mailgun", b"MAILGUN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:mailgun)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-h0-9]{32}-[a-h0-9]{8}-[a-h0-9]{8})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mapbox-api-token",
            anchors: &[b"mapbox", b"MAPBOX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mapbox", b"MAPBOX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:mapbox)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(pk\.[a-z0-9]{60}\.[a-z0-9]{22})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "mattermost-access-token",
            anchors: &[b"mattermost", b"MATTERMOST"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"mattermost", b"MATTERMOST"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:mattermost)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{26})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "maxmind-license-key",
            anchors: &[b"_mmk"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"_mmk"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b([A-Za-z0-9]{6}_[A-Za-z0-9]{29}_mmk)(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "messagebird-api-token",
            anchors: &[
                b"messagebird",
                b"MESSAGEBIRD",
                b"message-bird",
                b"MESSAGE-BIRD",
                b"message_bird",
                b"MESSAGE_BIRD",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"messagebird",
                b"MESSAGEBIRD",
                b"message-bird",
                b"MESSAGE-BIRD",
                b"message_bird",
                b"MESSAGE_BIRD",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:message[_-]?bird)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{25})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "messagebird-client-id",
            anchors: &[
                b"messagebird",
                b"MESSAGEBIRD",
                b"message-bird",
                b"MESSAGE-BIRD",
                b"message_bird",
                b"MESSAGE_BIRD",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"messagebird",
                b"MESSAGEBIRD",
                b"message-bird",
                b"MESSAGE-BIRD",
                b"message_bird",
                b"MESSAGE_BIRD",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:message[_-]?bird)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "microsoft-teams-webhook",
            anchors: &[b"webhook.office.com", b"webhookb2", b"incomingwebhook"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"webhook.office.com", b"webhookb2", b"incomingwebhook"]),
            entropy: None,
            // Capture groups 1-3 are for GUID repetition; we want the full URL as the
            // secret, so we explicitly set secret_group to 0 to override the default
            // group-1 preference.
            local_context: None,
            secret_group: Some(0),
            re: build_regex(
                r"https://[a-z0-9]+\.webhook\.office\.com/webhookb2/[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}@[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}/IncomingWebhook/[a-z0-9]{32}/[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}",
            ),
        },
        RuleSpec {
            name: "netlify-access-token",
            anchors: &[b"netlify", b"NETLIFY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"netlify", b"NETLIFY"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:netlify)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{40,46})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "new-relic-browser-api-token",
            anchors: &[b"nrjs-", b"NRJS-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"nrjs-", b"NRJS-"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:new-relic|newrelic|new_relic)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(NRJS-[a-f0-9]{19})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "new-relic-insert-key",
            anchors: &[b"nrii-", b"NRII-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"nrii-", b"NRII-"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:new-relic|newrelic|new_relic)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(NRII-[a-z0-9-]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "new-relic-user-api-id",
            anchors: &[
                b"new-relic",
                b"NEW-RELIC",
                b"newrelic",
                b"NEWRELIC",
                b"new_relic",
                b"NEW_RELIC",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"new-relic",
                b"NEW-RELIC",
                b"newrelic",
                b"NEWRELIC",
                b"new_relic",
                b"NEW_RELIC",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:new-relic|newrelic|new_relic)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "new-relic-user-api-key",
            anchors: &[b"nrak", b"NRAK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"nrak", b"NRAK"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:new-relic|newrelic|new_relic)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(NRAK-[a-z0-9]{27})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "notion-api-token",
            anchors: &[b"ntn_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"ntn_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b(ntn_[0-9]{11}[A-Za-z0-9]{32}[A-Za-z0-9]{3})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "npm-access-token",
            anchors: &[b"npm_", b"NPM_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"npm_", b"NPM_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(npm_[a-z0-9]{36})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "nuget-config-password",
            anchors: &[b"<add key=", b"<ADD KEY="],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"<add key=", b"<ADD KEY="]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 1.0,
                min_len: 16,
                max_len: 512,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)<add key=\"(?:(?:ClearText)?Password)\"\s*value=\"(.{8,})\"\s*/>"#,
            ),
        },
        RuleSpec {
            name: "nytimes-access-token",
            anchors: &[
                b"nytimes",
                b"NYTIMES",
                b"new-york-times",
                b"NEW-YORK-TIMES",
                b"newyorktimes",
                b"NEWYORKTIMES",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"nytimes",
                b"NYTIMES",
                b"new-york-times",
                b"NEW-YORK-TIMES",
                b"newyorktimes",
                b"NEWYORKTIMES",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:nytimes|new-york-times,|newyorktimes)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9=_\-]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "octopus-deploy-api-key",
            anchors: &[b"api-", b"API-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"api-", b"API-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(API-[A-Z0-9]{26})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "okta-access-token",
            anchors: &[b"okta", b"OKTA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"okta", b"OKTA"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"[\w.-]{0,50}?(?i:[\w.-]{0,50}?(?:(?-i:[Oo]kta|OKTA))(?:[ \t\w.-]{0,20})[\s'"]{0,3})(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(00[\w=\-]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "openai-api-key",
            anchors: &[b"t3blbkfj"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"t3blbkfj"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b(sk-(?:proj|svcacct|admin)-(?:[A-Za-z0-9_-]{74}|[A-Za-z0-9_-]{58})T3BlbkFJ(?:[A-Za-z0-9_-]{74}|[A-Za-z0-9_-]{58})\b|sk-[a-zA-Z0-9]{20}T3BlbkFJ[a-zA-Z0-9]{20})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "openshift-user-token",
            anchors: &[b"sha256~"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sha256~"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"\b(sha256~[\w-]{43})(?:[^\w-]|\z)"),
        },
        RuleSpec {
            name: "perplexity-api-key",
            anchors: &[b"pplx-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pplx-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(pplx-[a-zA-Z0-9]{48})(?:[\x60'"\s;]|\\[nr]|$|\b)"#),
        },
        // NOTE: gitleaks path-only rule; mapped to content regex here.
        RuleSpec {
            name: "pkcs12-file",
            anchors: &[b".p12", b".P12", b".pfx", b".PFX"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b".p12", b".P12", b".pfx", b".PFX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)(?:^|\/)[^\/]+\.p(?:12|fx)$"),
        },
        RuleSpec {
            name: "plaid-api-token",
            anchors: &[b"plaid", b"PLAID"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"plaid", b"PLAID"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:plaid)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(access-(?:sandbox|development|production)-[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "plaid-client-id",
            anchors: &[b"plaid", b"PLAID"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"plaid", b"PLAID"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:plaid)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{24})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "plaid-secret-key",
            anchors: &[b"plaid", b"PLAID"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"plaid", b"PLAID"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:plaid)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{30})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "planetscale-api-token",
            anchors: &[b"pscale_tkn_", b"PSCALE_TKN_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pscale_tkn_", b"PSCALE_TKN_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(pscale_tkn_(?i)[\w=\.-]{32,64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "planetscale-oauth-token",
            anchors: &[b"pscale_oauth_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pscale_oauth_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(pscale_oauth_[\w=\.-]{32,64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "planetscale-password",
            anchors: &[b"pscale_pw_", b"PSCALE_PW_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pscale_pw_", b"PSCALE_PW_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"(?i)\b(pscale_pw_(?i)[\w=\.-]{32,64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "postman-api-token",
            anchors: &[b"pmak-", b"PMAK-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pmak-", b"PMAK-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(PMAK-(?i)[a-f0-9]{24}\-[a-f0-9]{34})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "prefect-api-token",
            anchors: &[b"pnu_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pnu_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(pnu_[a-zA-Z0-9]{36})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "private-key",
            anchors: &[b"-----begin", b"-----BEGIN"],
            radius: 0,
            validator: ValidatorKind::None,
            two_phase: Some(TwoPhaseSpec {
                seed_radius: 256,
                full_radius: 16 * 1024,
                confirm_any: PRIVATE_KEY_CONFIRM,
            }),
            must_contain: None,
            keywords_any: Some(&[b"-----begin", b"-----BEGIN"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"(?i)-----BEGIN[ A-Z0-9_-]{0,100}PRIVATE KEY(?: BLOCK)?-----[\s\S-]{64,}?KEY(?: BLOCK)?-----",
            ),
        },
        RuleSpec {
            name: "privateai-api-token",
            anchors: &[b"privateai", b"private_ai", b"private-ai"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"privateai", b"private_ai", b"private-ai"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"[\w.-]{0,50}?(?i:[\w.-]{0,50}?(?:private[_-]?ai)(?:[ \t\w.-]{0,20})[\s'"]{0,3})(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{32})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "pulumi-api-token",
            anchors: &[b"pul-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pul-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(pul-[a-f0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "pypi-upload-token",
            anchors: &[b"pypi-ageichlwas5vcmc"],
            radius: 1064,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"pypi-ageichlwas5vcmc"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 1000,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"pypi-AgEIcHlwaS5vcmc[\w-]{50,1000}"),
        },
        RuleSpec {
            name: "rapidapi-access-token",
            anchors: &[b"rapidapi", b"RAPIDAPI"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"rapidapi", b"RAPIDAPI"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:rapidapi)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9_-]{50})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "readme-api-token",
            anchors: &[b"rdme_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"rdme_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(rdme_[a-z0-9]{70})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "rubygems-api-token",
            anchors: &[b"rubygems_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"rubygems_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(rubygems_[a-f0-9]{48})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "scalingo-api-token",
            anchors: &[b"tk-us-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"tk-us-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(tk-us-[\w-]{48})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "sendbird-access-id",
            anchors: &[b"sendbird", b"SENDBIRD"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sendbird", b"SENDBIRD"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:sendbird)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sendbird-access-token",
            anchors: &[b"sendbird", b"SENDBIRD"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sendbird", b"SENDBIRD"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:sendbird)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sendgrid-api-token",
            // Only uppercase anchor - regex requires uppercase: SG\.(?i)
            anchors: &[b"SG."],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"SG."]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(SG\.(?i)[a-z0-9=_\-\.]{66})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "sendinblue-api-token",
            anchors: &[b"xkeysib-", b"XKEYSIB-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xkeysib-", b"XKEYSIB-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b(xkeysib-[a-f0-9]{64}\-(?i)[a-z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sentry-access-token",
            anchors: &[b"sentry", b"SENTRY"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sentry", b"SENTRY"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:sentry)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sentry-org-token",
            anchors: &[b"sntrys_eyjpyxqio"],
            radius: 264,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sntrys_eyjpyxqio"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"\bsntrys_eyJpYXQiO[a-zA-Z0-9+/]{10,200}(?:LCJyZWdpb25fdXJs|InJlZ2lvbl91cmwi|cmVnaW9uX3VybCI6)[a-zA-Z0-9+/]{10,200}={0,2}_[a-zA-Z0-9+/]{43}(?:[^a-zA-Z0-9+/]|\z)",
            ),
        },
        RuleSpec {
            name: "sentry-user-token",
            anchors: &[b"sntryu_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sntryu_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sntryu_[a-f0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "settlemint-application-access-token",
            anchors: &[b"sm_aat"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sm_aat"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sm_aat_[a-zA-Z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "settlemint-personal-access-token",
            anchors: &[b"sm_pat"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sm_pat"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sm_pat_[a-zA-Z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "settlemint-service-access-token",
            anchors: &[b"sm_sat"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sm_sat"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(sm_sat_[a-zA-Z0-9]{16})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "shippo-api-token",
            anchors: &[b"shippo_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"shippo_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(shippo_(?:live|test)_[a-fA-F0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "shopify-access-token",
            anchors: &[b"shpat_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"shpat_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"shpat_[a-fA-F0-9]{32}"),
        },
        RuleSpec {
            name: "shopify-custom-access-token",
            anchors: &[b"shpca_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"shpca_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"shpca_[a-fA-F0-9]{32}"),
        },
        RuleSpec {
            name: "shopify-private-app-access-token",
            anchors: &[b"shppa_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"shppa_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"shppa_[a-fA-F0-9]{32}"),
        },
        RuleSpec {
            name: "shopify-shared-secret",
            anchors: &[b"shpss_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"shpss_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"shpss_[a-fA-F0-9]{32}"),
        },
        RuleSpec {
            name: "sidekiq-secret",
            anchors: &[
                b"bundle_enterprise__contribsys__com",
                b"BUNDLE_ENTERPRISE__CONTRIBSYS__COM",
                b"bundle_gems__contribsys__com",
                b"BUNDLE_GEMS__CONTRIBSYS__COM",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"bundle_enterprise__contribsys__com",
                b"BUNDLE_ENTERPRISE__CONTRIBSYS__COM",
                b"bundle_gems__contribsys__com",
                b"BUNDLE_GEMS__CONTRIBSYS__COM",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:BUNDLE_ENTERPRISE__CONTRIBSYS__COM|BUNDLE_GEMS__CONTRIBSYS__COM)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-f0-9]{8}:[a-f0-9]{8})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sidekiq-sensitive-url",
            anchors: &[
                b"gems.contribsys.com",
                b"GEMS.CONTRIBSYS.COM",
                b"enterprise.contribsys.com",
                b"ENTERPRISE.CONTRIBSYS.COM",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"gems.contribsys.com",
                b"GEMS.CONTRIBSYS.COM",
                b"enterprise.contribsys.com",
                b"ENTERPRISE.CONTRIBSYS.COM",
            ]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"(?i)\bhttps?://([a-f0-9]{8}:[a-f0-9]{8})@(?:gems.contribsys.com|enterprise.contribsys.com)(?:[\/|\#|\?|:]|$)",
            ),
        },
        RuleSpec {
            name: "slack-app-token",
            anchors: &[b"xapp", b"XAPP"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xapp", b"XAPP"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 512,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)xapp-\d-[A-Z0-9]+-\d+-[a-z0-9]+"),
        },
        RuleSpec {
            name: "slack-bot-token",
            anchors: &[b"xoxb"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxb"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"xoxb-[0-9]{10,13}-[0-9]{10,13}[a-zA-Z0-9-]*"),
        },
        RuleSpec {
            name: "slack-config-access-token",
            anchors: &[b"xoxe.xoxb-", b"XOXE.XOXB-", b"xoxe.xoxp-", b"XOXE.XOXP-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxe.xoxb-", b"XOXE.XOXB-", b"xoxe.xoxp-", b"XOXE.XOXP-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)xoxe.xox[bp]-\d-[A-Z0-9]{163,166}"),
        },
        RuleSpec {
            name: "slack-config-refresh-token",
            anchors: &[b"xoxe-", b"XOXE-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxe-", b"XOXE-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"(?i)xoxe-\d-[A-Z0-9]{146}"),
        },
        RuleSpec {
            name: "slack-legacy-bot-token",
            anchors: &[b"xoxb"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxb"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"xoxb-[0-9]{8,14}-[a-zA-Z0-9]{18,26}"),
        },
        RuleSpec {
            name: "slack-legacy-token",
            anchors: &[b"xoxo", b"xoxs"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxo", b"xoxs"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 512,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"xox[os]-\d+-\d+-\d+-[a-fA-F\d]+"),
        },
        RuleSpec {
            name: "slack-legacy-workspace-token",
            anchors: &[b"xoxa", b"xoxr"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxa", b"xoxr"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"xox[ar]-(?:\d-)?[0-9a-zA-Z]{8,48}"),
        },
        RuleSpec {
            name: "slack-user-token",
            anchors: &[b"xoxp-", b"xoxe-"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"xoxp-", b"xoxe-"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"xox[pe](?:-[0-9]{10,13}){3}-[a-zA-Z0-9-]{28,34}"),
        },
        RuleSpec {
            name: "slack-webhook-url",
            anchors: &[b"hooks.slack.com"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hooks.slack.com"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r"(?:https?://)?hooks.slack.com/(?:services|workflows|triggers)/[A-Za-z0-9+/]{43,56}",
            ),
        },
        RuleSpec {
            name: "snyk-api-token",
            anchors: &[b"snyk", b"SNYK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"snyk", b"SNYK"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:snyk[_.-]?(?:(?:api|oauth)[_.-]?)?(?:key|token))(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sonar-api-token",
            anchors: &[b"sonar", b"SONAR"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sonar", b"SONAR"]),
            entropy: None,
            // Group 1 captures "login"|"token" keyword; group 2 captures the actual secret.
            local_context: None,
            secret_group: Some(2),
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:sonar[_.-]?(login|token))(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}((?:squ_|sqp_|sqa_)?[a-z0-9=_\-]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        // Sourcegraph tokens always have "sgp_" prefix. We intentionally exclude:
        // - Generic 40-hex patterns ([a-fA-F0-9]{40}) which match git SHAs, checksums, etc.
        // - "sourcegraph" keyword anchors which trigger on docs/URLs without tokens
        // This reduces false positives significantly while catching all structured token formats.
        RuleSpec {
            name: "sourcegraph-access-token",
            anchors: &[b"sgp_", b"SGP_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sgp_", b"SGP_"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)\b(sgp_(?:[a-fA-F0-9]{16}|local)_[a-fA-F0-9]{40}|sgp_[a-fA-F0-9]{40})\b(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "square-access-token",
            anchors: &[b"sq0atp-", b"eaaa", b"EAAA"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sq0atp-", b"eaaa", b"EAAA"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b((?:EAAA|sq0atp-)[\w-]{22,60})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "squarespace-access-token",
            anchors: &[b"squarespace", b"SQUARESPACE"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"squarespace", b"SQUARESPACE"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:squarespace)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "stripe-access-token",
            anchors: &[
                b"sk_test", b"sk_live", b"sk_prod", b"rk_test", b"rk_live", b"rk_prod",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[
                b"sk_test", b"sk_live", b"sk_prod", b"rk_test", b"rk_live", b"rk_prod",
            ]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 2.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"\b((?:sk|rk)_(?:test|live|prod)_[a-zA-Z0-9]{10,99})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sumologic-access-id",
            anchors: &[b"sumo", b"SUMO"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sumo", b"SUMO"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"[\w.-]{0,50}?(?i:[\w.-]{0,50}?(?:(?-i:[Ss]umo|SUMO))(?:[ \t\w.-]{0,20})[\s'"]{0,3})(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(su[a-zA-Z0-9]{12})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "sumologic-access-token",
            anchors: &[b"sumo", b"SUMO"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"sumo", b"SUMO"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:(?-i:[Ss]umo|SUMO))(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{64})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "telegram-bot-api-token",
            anchors: &[b"telegr", b"TELEGR"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"telegr", b"TELEGR"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:telegr)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9]{5,16}:(?-i:A)[a-z0-9_\-]{34})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "travisci-access-token",
            anchors: &[b"travis", b"TRAVIS"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"travis", b"TRAVIS"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:travis)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{22})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        // OPTIMIZED: Twilio API keys always start with "SK" followed by 32 hex chars.
        // The "SK" prefix alone is too short (2 chars < min_anchor_len=3).
        // Extend anchors to "SK[0-9a-fA-F]" patterns (3 chars each) for 32 variants.
        // This is safe: any match of SK[0-9a-fA-F]{32} contains one of these anchors.
        RuleSpec {
            name: "twilio-api-key",
            anchors: &[
                b"SK0", b"SK1", b"SK2", b"SK3", b"SK4", b"SK5", b"SK6", b"SK7", b"SK8", b"SK9",
                b"SKa", b"SKb", b"SKc", b"SKd", b"SKe", b"SKf", b"SKA", b"SKB", b"SKC", b"SKD",
                b"SKE", b"SKF",
            ],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"SK"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.0,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r"SK[0-9a-fA-F]{32}"),
        },
        RuleSpec {
            name: "twitch-api-token",
            anchors: &[b"twitch", b"TWITCH"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitch", b"TWITCH"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitch)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{30})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "twitter-access-secret",
            anchors: &[b"twitter", b"TWITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitter", b"TWITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{45})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "twitter-access-token",
            anchors: &[b"twitter", b"TWITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitter", b"TWITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([0-9]{15,25}-[a-zA-Z0-9]{20,40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "twitter-api-key",
            anchors: &[b"twitter", b"TWITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitter", b"TWITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{25})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "twitter-api-secret",
            anchors: &[b"twitter", b"TWITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitter", b"TWITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{50})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "twitter-bearer-token",
            anchors: &[b"twitter", b"TWITTER"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"twitter", b"TWITTER"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:twitter)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(A{22}[a-zA-Z0-9%]{80,100})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "typeform-api-token",
            anchors: &[b"tfp_", b"TFP_"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"tfp_", b"TFP_"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:typeform)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(tfp_[a-z0-9\-_\.=]{59})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "vault-batch-token",
            anchors: &[b"hvb."],
            radius: 364,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hvb."]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 4.0,
                min_len: 16,
                max_len: 300,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(hvb\.[\w-]{138,300})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        // OPTIMIZED: Split into two rules to avoid the noisy "s." anchor.
        // Modern Vault tokens use "hvs." prefix (4 chars, distinctive).
        // Legacy tokens use "s." prefix (2 chars, extremely noisy: matches "e.g.", "3.14", etc.)
        // See docs/anchor_optimization_spec.md for details.
        //
        // Rule 1: Modern hvs. tokens - no change needed, anchor is already safe
        RuleSpec {
            name: "vault-service-token",
            anchors: &[b"hvs."],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"hvs."]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(hvs\.[\w-]{90,120})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        // Rule 2: Legacy s. tokens - require "vault" keyword context via two-phase
        // This trades a small chance of missing contextless legacy tokens for much better
        // performance on data that contains "s." patterns (decimals, abbreviations, etc.)
        RuleSpec {
            name: "vault-service-token-legacy",
            anchors: &[b"vault", b"VAULT", b"Vault"],
            radius: 512,
            validator: ValidatorKind::None,
            two_phase: Some(TwoPhaseSpec {
                seed_radius: 128,
                full_radius: 512,
                confirm_any: &[b"s."],
            }),
            must_contain: None,
            keywords_any: Some(&[b"vault", b"VAULT", b"Vault"]),
            entropy: Some(EntropySpec {
                min_bits_per_byte: 3.5,
                min_len: 16,
                max_len: 256,
            }),
            local_context: None,
            secret_group: None,
            re: build_regex(r#"\b(s\.[a-zA-Z0-9]{24})(?:[\x60'"\s;]|\\[nr]|$)"#),
        },
        RuleSpec {
            name: "yandex-access-token",
            anchors: &[b"yandex", b"YANDEX"],
            radius: 2048,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"yandex", b"YANDEX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:yandex)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(t1\.[A-Z0-9a-z_-]+[=]{0,2}\.[A-Z0-9a-z_-]{86}[=]{0,2})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "yandex-api-key",
            anchors: &[b"yandex", b"YANDEX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"yandex", b"YANDEX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:yandex)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(AQVN[A-Za-z0-9_\-]{35,38})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "yandex-aws-access-token",
            anchors: &[b"yandex", b"YANDEX"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"yandex", b"YANDEX"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:yandex)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}(YC[a-zA-Z0-9_\-]{38})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
        RuleSpec {
            name: "zendesk-secret-key",
            anchors: &[b"zendesk", b"ZENDESK"],
            radius: 256,
            validator: ValidatorKind::None,
            two_phase: None,
            must_contain: None,
            keywords_any: Some(&[b"zendesk", b"ZENDESK"]),
            entropy: None,
            local_context: None,
            secret_group: None,
            re: build_regex(
                r#"(?i)[\w.-]{0,50}?(?:zendesk)(?:[ \t\w.-]{0,20})[\s'"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5}([a-z0-9]{40})(?:[\x60'"\s;]|\\[nr]|$)"#,
            ),
        },
    ]
}
